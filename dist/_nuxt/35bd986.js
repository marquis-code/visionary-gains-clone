(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{704:function(e,t,n){"use strict";n.r(t);n(10),n(30),n(32),n(8);var r=n(48),o=(n(94),n(27),n(13),{layout:"customer-dashboard",data:function(){return{processing:!1,userData:{},form:{plan:"",amount:""}}},computed:{isFormEmpty:function(){return!(!this.form.plan||!this.form.amount)}},mounted:function(){this.getUserInfo()},methods:{buyPlan:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.processing=!0,n=JSON.parse(window.localStorage.getItem("auth")),t.prev=2,r="\n        mutation {\n          buyPlan(amount: ".concat(e.form.amount,', planType: "').concat(e.form.plan,'")\n        }\n      '),t.next=6,fetch("https://lucent-kq5b.onrender.com/graphql/query",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+n},body:JSON.stringify({query:r,variables:{amount:e.form.amount,planType:e.form.plan}})});case 6:return o=t.sent,t.next=9,o.json();case 9:null!=(data=t.sent)&&data.errors?e.$toastr.e(data.errors[0].message):(e.$toastr.s("You have successfully purchased a plan"),e.form.amount="",e.form.plan="");case 11:return t.prev=11,e.processing=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[2,,11,14]])})))()},formatNumberAsDollar:function(e){return null==e?void 0:e.toLocaleString("en-US",{style:"currency",currency:"USD"})},getUserInfo:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,n=JSON.parse(window.localStorage.getItem("auth")),e.loading=!0,t.prev=4,t.next=7,fetch("https://lucent-kq5b.onrender.com/graphql/query",{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer "+n},body:JSON.stringify({query:"\n        query {\n          getUser {\n            id\n            firstName\n            lastName\n            email\n            Status\n            PlanType\n            accountBalance\n            tradingBalance\n            profit\n            eth\n            btc\n            timeAdded\n          }\n        }\n      "})});case 7:return r=t.sent,t.next=10,r.json();case 10:null!=(data=t.sent)&&data.errors?e.$toastr.e(data.errors[0].message):e.userData=data.data.getUser;case 12:return t.prev=12,e.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[4,,12,15]])})))()}}}),l=n(38),component=Object(l.a)(o,(function(){var e,t,n=this,r=n._self._c;return r("div",{staticClass:"h-screen overflow-y-auo"},[r("section",{staticClass:"bg-white lg:w-5/12 rounded-md border h-[500px]"},[r("p",{staticClass:"border-b text-sm font-semibold py-4 pl-6"},[n._v("\n      To buy a plan, select PLAN of your choice.\n    ")]),n._v(" "),r("form",{staticClass:"p-6 space-y-6 z-10",on:{submit:function(e){return e.preventDefault(),n.buyPlan.apply(null,arguments)}}},[r("div",{staticClass:"space-y-1"},[r("label",{staticClass:"text-xs text-gray-700 font-medium"},[n._v("Choose Plan:*")]),n._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:n.form.plan,expression:"form.plan"}],staticClass:"block px-2 text-sm outline-none py-3 rounded-md border w-full border-transparent border-l-4 group-hover:border-blue-600 group-hover:bg-gray-100",on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));n.$set(n.form,"plan",e.target.multiple?t:t[0])}}},n._l([{name:"Platinum Plan (29%) Monthly",value:"Platinum"},{name:"Diamond Plan (35%) Monthly",value:"Diamond"}],(function(e,t){return r("option",{key:t,domProps:{value:e.value}},[n._v("\n            "+n._s(e.name)+"\n          ")])})),0)]),n._v(" "),r("div",{staticClass:"space-y-1"},[r("label",{staticClass:"text-xs text-gray-700 font-medium"},[n._v("Enter Amount:*")]),n._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:n.form.amount,expression:"form.amount"}],staticClass:"py-2.5 border rounded-md w-full outline-none pl-6",domProps:{value:n.form.amount},on:{input:function(e){e.target.composing||n.$set(n.form,"amount",e.target.value)}}}),n._v(" "),r("span",{staticClass:"text-xs font-medium text-red-500"},[n._v("Note that plan amount must be available in your account balance of\n          "+n._s(null!==(e=n.formatNumberAsDollar(null===(t=n.userData)||void 0===t?void 0:t.accountBalance))&&void 0!==e?e:"0.00")+".")])]),n._v(" "),r("button",{staticClass:"w-full text-white text-sm rounded-lg bg-black py-3",class:[!n.isFormEmpty||n.processing?"opacity-25 cursor-not-allowed":""],attrs:{disabled:!n.isFormEmpty}},[n._v("\n        "+n._s(n.processing?"processing....":"Proceed")+"\n      ")])])])])}),[],!1,null,null,null);t.default=component.exports}}]);